<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ck-multiselect-grid demo</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 2rem;
      }
      .demo-row {
        display: grid;
        gap: 1rem;
        max-width: 720px;
      }
      input,
      textarea {
        width: 100%;
        padding: 0.5rem;
      }
      textarea {
        min-height: 4.5rem;
        font-family: monospace;
      }

      ck-multiselect-grid {
        --input-border: #d0d5dd;
        --card-bg: #ffffff;
        --surface-bg: #eef2ff;
        --primary-color: #4338ca;
        --focus-border: #4338ca;
        --focus-shadow: 0 0 0 2px rgba(67, 56, 202, 0.2);
        --option-pill-color: #0f172a;
        --option-pill-active-bg: #4338ca;
        --text-light: #ffffff;
        --form-bg: #e2e8f0;
      }
    </style>
  </head>
  <body>
    <h1>ck-multiselect-grid demo</h1>
    <p>
      Tip: Values listed in <code>selectedItems</code> are rendered even if they are missing
      from <code>availableItems</code>. Try removing "Item.PolicyOnly" from the available list and
      notice the pill stays visible.
    </p>

    <div class="demo-row">
      <ck-multiselect-grid
        id="grid"
        title="Select Items"
        description="Choose the items that apply to this client."
        fieldset-id="ck-multiselect-grid-fieldset"
        fieldset-class="selection-block"
        availableItems='["Item.Read","Item.Write","Item.Manage"]'
        selectedItems='["Item.Write","Item.PolicyOnly"]'
      ></ck-multiselect-grid>

      <label>
        Title
        <input id="title" value="Select Items" />
      </label>

      <label>
        Description
        <input
          id="description"
          value="Choose the items that apply to this client."
        />
      </label>

      <label>
        Fieldset ID
        <input id="fieldset-id" value="ck-multiselect-grid-fieldset" />
      </label>

      <label>
        Fieldset Classes (space-delimited)
        <input id="fieldset-class" value="selection-block" />
      </label>

      <label>
        Available Items (JSON array)
        <textarea id="available-items">["Item.Read","Item.Write","Item.Manage"]</textarea>
      </label>

      <label>
        Selected Items (JSON array)
        <textarea id="selected-items">["Item.Write","Item.PolicyOnly"]</textarea>
      </label>

      <div>
        <strong>Event log</strong>
        <pre id="event-log" style="min-height: 4rem; background: #0f172a; color: #f8fafc; padding: 0.5rem; border-radius: 0.25rem; overflow: auto;"></pre>
      </div>
    </div>

    <script type="module">
      // Requires a build output (run `npm run build` first)
      import '../dist/ck-multiselect-grid/ck-multiselect-grid.esm.js';

      const grid = document.getElementById('grid');
      const eventLog = document.getElementById('event-log');
      const titleInput = document.getElementById('title');
      const descriptionInput = document.getElementById('description');
      const fieldsetIdInput = document.getElementById('fieldset-id');
      const fieldsetClassInput = document.getElementById('fieldset-class');
      const availableItemsInput = document.getElementById('available-items');
      const selectedItemsInput = document.getElementById('selected-items');

      const sync = () => {
        grid.setAttribute('title', titleInput.value);
        grid.setAttribute('description', descriptionInput.value);
        grid.setAttribute(
          'fieldset-id',
          fieldsetIdInput.value || 'ck-multiselect-grid-fieldset'
        );

        const nextClass = fieldsetClassInput.value.trim();
        if (nextClass) {
          grid.setAttribute('fieldset-class', nextClass);
        } else {
          grid.removeAttribute('fieldset-class');
        }

        const nextAvailable = availableItemsInput.value.trim();
        if (nextAvailable) {
          grid.setAttribute('availableItems', nextAvailable);
        } else {
          grid.removeAttribute('availableItems');
        }

        const nextSelected = selectedItemsInput.value.trim();
        if (nextSelected) {
          grid.setAttribute('selectedItems', nextSelected);
        } else {
          grid.removeAttribute('selectedItems');
        }
      };

      titleInput.addEventListener('input', sync);
      descriptionInput.addEventListener('input', sync);
      fieldsetIdInput.addEventListener('input', sync);
      fieldsetClassInput.addEventListener('input', sync);
      availableItemsInput.addEventListener('input', sync);
      selectedItemsInput.addEventListener('input', sync);

      const logEvent = event => {
        const { option, checked } = event.detail;
        const nextLine = `${new Date().toLocaleTimeString()} -> ${checked ? 'selected' : 'unselected'} ${option.value}`;
        eventLog.textContent = `${nextLine}\n${eventLog.textContent}`.trim().slice(0, 800);
      };

      grid.addEventListener('ck-multiselect-option-selected', logEvent);
      grid.addEventListener('ck-multiselect-option-unselected', logEvent);
    </script>
  </body>
</html>

